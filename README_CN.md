# Protocol 75 (v0.1.1)

Protocol 75 是构建在 Aptos 链上的“Web3 人类自律信用协议”。它利用区块链的不可篡改性和智能合约的自动执行能力，将非标的个人自律行为（如运动、睡眠、作息）转化为可量化的链上信用资产 (Bio-Credit)。项目摒弃了传统的 GameFi 旁氏模型，基于行为经济学的“损失厌恶”原理，构建了一个“质押-验证-结算”的正向激励闭环。

## 开发指南 (Development)

### 智能合约架构 (Architecture)

本项目采用 **Manager-Storage** 分层架构，包含以下核心模块：

- **challenge_manager**: 业务逻辑核心层，负责协调挑战创建、资金锁定、每日打卡及结算。
- **bio_credit**: 用户身份层 (Storage)，管理 BioSoul (SBT)、个人连胜记录及勋章挂载。
- **asset_manager**: 资金管理层，负责与 DeFi 协议交互、资金锁仓及清算分配。
- **task_market**: 策略层，定义任务规格及难度计算算法。
- **badge_factory**: 资产层，负责铸造系统成就勋章及商业品牌勋章。

![Smart Contract Architecture](./public/smart_contract_architecture.png)

这类似于面向对象编程中的“类图设计”，但在 Move 语言中体现为模块 (Module)、资源 (Resource) 和能力 (Capability) 的组合。

### 项目结构 (Project Structure)

```text
protocol_75/
├── Move.toml
├── sources/
│   ├── task_market.move        # 任务定义与难度计算
│   ├── badge_factory.move      # 勋章铸造
│   ├── bio_credit.move         # 信用分与SBT存储
│   ├── asset_manager.move      # 资产托管
│   ├── challenge_manager.move  # 核心业务控制器
│   ├── utils/
│   │   └── bio_math.move       # [NEW] 纯数学逻辑库 (积分类)
│   └── mocks/
│       └── test_usd.move       # 测试用代币
└── tests/
    └── full_scenario_test.move # 全流程测试
```

### 环境要求 (Environment)

- **Language**: Move 2.0+
- **Network**: Aptos Testnet
- **Framework**: Aptos Framework (Testnet Release)

## 协议规范 (Protocol Specification)

### 账户体系与准入 (Account System & Access)

- **无许可准入 (Permissionless)**: 建立在 Aptos 公链之上，任何使用兼容钱包的用户均可接入。
- **抗女巫门槛 (Anti-Sybil)**: 用户需支付一次性入场费 **0.75 USDT** 以防止女巫攻击。
- **自律信用 (Bio-Credit)**: 首次接入时，自动铸造不可转移的 **Soulbound Token (SBT)** 作为用户自律信用的载体。
  - SBT 强制与用户物理健康账户（如 Apple Health）的哈希指纹 **1:1 绑定**。
  - 作为 **Master Object**，SBT 记录核心信用分，并拥有挂载 **Sub-Objects**（如 B端商业勋章、连胜徽章）的能力，形成聚合资产结构。

### 组件化任务系统 (Componentized Task System)

- **任务组件库**: 协议提供标准化的 **原子任务组件**（如跑步、睡眠、冥想）。
- **自由组合**: 用户可自由编排多个原子任务，并自定义参数（质押金额、持续时间、强度阈值）生成独立的 **“任务对象” (Task Object)**。
- **难度合成**: 系统利用链上算法，基于任务数量、强度及质押金额，实时合成综合 **难度系数 (Difficulty)**。
- **验证标准**: 协议只接受来自物理健康账户的 **硬件签名数据**，通过多维交叉验证（GPS、心率、时间戳等）杜绝作弊。隐私数据保留在本地，仅由 **零知识证明 (ZKP)** 或验证结果上链。

### 挑战模式与结算 (Challenge Modes & Settlement)

- **稳定币结算**: 全程采用 Aptos 原生 **USDT/USDC** 进行质押与结算，消除加密资产波动风险。
- **启动模式**:
  - **哈希组队 (Hash Team)**: 普通用户必须以 4-7 人小队形式启动。系统基于成员地址组合生成的 **Team Hash** 识别小队身份。
  - **白名单启动**: 白名单协议账户（通常为 B端商家）可开启无人数上限的挑战（如万人马拉松）。
  - **挑战周期**: 通常设为周的整数倍。
- **连带责任制**:
  - **全员达标**: 本金全额退回 + 小队共享底层 DeFi 收益。
  - **部分违约**: 内部赔偿机制，违约者的本金及收益直接平分给合规队友。
  - **全员团灭**: 触发 **“黑洞机制”**，所有本息被协议没收（注入国库/慈善），无退款。
- **信用独立**:
  - **分数隔离**: SBT 分数变化仅取决于个人表现。
  - **无连带惩罚**: 队友违约不扣除合规用户的 SBT 信用分。

### 资产托管模型 (Asset Custody Model)

- **本金保本理财**: 从开始到结束，协议自动将质押资产投入经过验证的链上保本理财协议（如 **Aries Market** 或 **Thala**），作为逻辑锁仓。
- **非托管所有权**: 产生的理财凭证存储在用户账户下的 **Move Resource Module** 中，即使用户也拥有该资产的唯一所有权凭证，协议无法挪用。
- **逃生舱机制**: 若链下结算系统在设定时间（如 T+7天）内未响应，强制取款接口将开启。

### [Algorithm 2.0] 数据价值与权益 (Data Value & Rights)

SBT 信用分核心算法已升级为 **Bio-Math 2.0** 版本，采用 **分段积分 (Integration)** 与 **能量流 (Energy Flow)** 模型：

#### 1. 核心数学模型 (Core Math)
- **分数区间**: 35.0 (初始下限) ~ 95.0 (理论上限)。初始分为 50.0。
- **阻力曲线 (Cost Curve)**:
  - **修复期 (35-50)**: Cost 1.0 -> 1.25。低阻力，鼓励快速回归。
  - **积累期 (50-75)**: Cost 1.25 -> 3.0。线性增长，反映习惯养成的难度。
  - **精英期 (75-95)**: Cost 3.0 -> 10.0。指数级阻力，每一分都极难获取。

#### 2. “能量”经济学 (Energy Standard)
为了确保公平性与长期激励，我们锁定了以下不可变的经济学常数：

- **能量放大系数 (Scaling Factor): 600**
  - 公式: `Energy = Difficulty * Count * 600`
  - **设计目标**: 让用户从 50 分涨到 75 分（Benchmark Line），在平均难度下需要坚持约 **180 天 (6个月)**。
  - 这意味着：一个难度为 500 的标准任务，每天打卡可获得 300,000 能量，在初期约等于 +0.24 分。

- **衰减基础 (Decay Base): 75,000**
  - **1:4 黄金比例**: 坚持锻炼 1 天获得的能量，足以抵消 4 天的自然衰减。
  - 公式: `DailyLoss = 75,000 * CurrentCost`
  - 这意味着：偶尔的休息是被允许的，通过打卡积累的能量可以形成“护盾”。

#### 3. 动态结算机制 (Dynamic Settlement)
- **豁免重置**: **每一次** 有效打卡（Check-in）都会立即重置衰减倒计时。只要保持活跃，衰减永远追不上你。
- **所见即所得**: 所有的分数增减在链上实时结算，原子化执行。

---

### 协议经济与分润模型 (Protocol Economy)

- **理财抽成**: 产生的 DeFi 收益中，**8%** 归国库，**2%** 归慈善，剩余 **90%** 归**用户**。
- **清算抽成**: 部分违约时，被罚没资金的 **4%** 归国库，**1%** 归慈善。全员团灭时，协议没收质押金的 **80%**，其中 **20%** 流向慈善。
- **B端抽成**: 外部机构（品牌、保险、AI公司）开设商业盘口（注入资金）时，**8%** 归国库，**2%** 归慈善，剩余 **90%** 形成**商业奖池**。

## 架构优势 (Design Advantages)

### 物理锚定的抗女巫机制
SBT 与物理健康账户哈希 **1:1 强绑定**，结合入场费门槛，有效防止了“批量撸毛”和“低成本刷号”的投机行为。

### 基于 Move 的非托管安全
- **分散存储**: 资产封装为独立的 Move Resource 对象存储在用户地址下，而非合约大资金池中。
- **最小化攻击面**: 即使合约逻辑被攻破，黑客也无法一次性卷走所有用户资金。

### 病毒式社交裂变
- **强制组队**: 必须 4-7 人组队的设计模仿了“约局”逻辑，逼迫核心用户在社交圈内拉人。
- **连带责任**: “一人违约，全队受损”的机制将“意志力驱动”转化为更强大的“社交声誉驱动”，极大提高了任务完成率和用户粘性。
